<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util" xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
						http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd">

    <!--
        isaver datasource
     -->
    <bean id="isaverDataSource" class="org.apache.commons.dbcp2.BasicDataSource">
        <qualifier value="isaverDataSource" />
        <property name="driverClassName" value="#{configProperties['db.isaver.driver']}" />
        <property name="url" value="#{configProperties['db.isaver.url']}" />
        <property name="username" value="#{configProperties['db.isaver.username']}" />
        <property name="password" value="#{configProperties['db.isaver.password']}" />
        <property name="maxTotal" value="#{configProperties['db.isaver.maxTotal']}" />
        <property name="defaultQueryTimeout" value="#{configProperties['db.isaver.defaultQueryTimeout']}" />
        <property name="defaultAutoCommit" value="false" />
        <property name="validationQuery" value="select 1" />
    </bean>

    <bean id="isaverSqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
        <property name="dataSource" ref="isaverDataSource" />
        <property name="mapperLocations" value="classpath*:com/icent/isaver/repository/mapper/base/*.xml" />
        <property name="typeAliasesPackage" value="com.icent.isaver.repository.bean" />
    </bean>

    <bean id="isaverSqlSession" class="org.mybatis.spring.SqlSessionTemplate">
        <constructor-arg index="0" ref="isaverSqlSessionFactory" />
    </bean>

    <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
        <property name="basePackage" value="com.icent.isaver.repository.dao.base" />
        <property name="sqlSessionFactoryBeanName" value="isaverSqlSessionFactory" />
    </bean>

    <!-- ########### -->
    <!-- Transaction Manager -->
    <!-- ########### -->
    <tx:annotation-driven transaction-manager="mybatisIsaverTxManager" />

    <!-- isaver -->
    <bean id="mybatisIsaverTxManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="isaverDataSource" />
        <qualifier value="mybatisIsaverTxManager" />
    </bean>
</beans>
